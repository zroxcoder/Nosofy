<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Planner | Nosofy</title>

<link rel="icon" href="../assets/N.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
<link rel="stylesheet" href="../styles/planner.css">
</head>
<body>

<div id="sidebar">
        <h3>NOSOFY</h3>
        <a class="nav-link" href="dashboard.html">üè† Dashboard</a>
        <a class="nav-link" href="notes.html">üìù Notes</a>
        <a class="nav-link active" href="planner.html">üìÖ Planner</a>
        <a class="nav-link" href="projects.html">üóÇÔ∏è Projects</a>
        <a class="nav-link" href="courses.html">üìí Courses</a>
        <a class="nav-link" href="expenses.html">üí∞ Expenses</a>
        <a class="nav-link" href="passwords.html">üîê Vault</a>
        <a class="nav-link" href="cloudhub.html">‚òÅÔ∏è Cloud Hub</a>
        <a class="nav-link" href="chatbot.html">üëæ Chat Bot</a>
        <a class="nav-link" href="profile.html">‚öôÔ∏è Profile</a>
</div>

<div class="content">
    <h2 class="section-title">Planner / To-Do List & Watchlist</h2>

    <!-- NEW: Mode Toggle -->
    <div class="mode-toggle">
        <button id="tasksTab" class="active" onclick="switchMode('tasks')">
            <i class="bi bi-list-check"></i> Tasks & To-Do
        </button>
        <button id="watchlistTab" onclick="switchMode('watchlist')">
            <i class="bi bi-camera-reels"></i> Watchlist
        </button>
    </div>

    <!-- TASKS SECTION -->
    <div id="tasksSection">
        <div class="stats-bar">
            <div class="stat-box"><i class="bi bi-list-task"></i> Total: <span id="totalCount">0</span></div>
            <div class="stat-box"><i class="bi bi-check-circle"></i> Completed: <span id="completedCount">0</span></div>
            <div class="stat-box"><i class="bi bi-clock-history"></i> Pending: <span id="pendingCount">0</span></div>
            <div class="stat-box"><i class="bi bi-exclamation-triangle"></i> Overdue: <span id="overdueCount">0</span></div>
            <div class="stat-box"><i class="bi bi-pin-angle-fill"></i> Pinned: <span id="pinnedCount">0</span></div>
            <div class="stat-box"><i class="bi bi-archive-fill"></i> Archived: <span id="archivedCount">0</span></div>
        </div>

        <div class="top-controls">
            <input type="text" id="searchInput" onkeyup="loadTasks()" placeholder="üîç Search tasks...">
            
            <select id="priorityFilter" onchange="loadTasks()">
                <option value="all">All Priorities</option>
                <option value="High">High Priority</option>
                <option value="Medium">Medium Priority</option>
                <option value="Low">Low Priority</option>
            </select>

            <select id="statusFilter" onchange="loadTasks()">
                <option value="all">All Status</option>
                <option value="completed">Completed</option>
                <option value="pending">Pending</option>
                <option value="overdue">Overdue</option>
                <option value="due-today">Due Today</option>
            </select>

            <select id="categoryFilter" onchange="loadTasks()">
                <option value="all">All Categories</option>
                <option value="Work">Work</option>
                <option value="Personal">Personal</option>
                <option value="Study">Study</option>
                <option value="Health">Health</option>
                <option value="Other">Other</option>
            </select>

            <select id="sortBy" onchange="loadTasks()">
                <option value="date-desc">Latest First</option>
                <option value="date-asc">Oldest First</option>
                <option value="deadline-asc">Deadline (Nearest)</option>
                <option value="deadline-desc">Deadline (Farthest)</option>
                <option value="title-asc">Title A-Z</option>
                <option value="title-desc">Title Z-A</option>
                <option value="priority">Priority</option>
            </select>

            <select id="viewMode" onchange="toggleViewMode()">
                <option value="grid">Grid View</option>
                <option value="list">List View</option>
            </select>

            <button onclick="toggleArchiveView()">
                <span id="archiveViewText"><i class="bi bi-archive"></i> Show Archived</span>
            </button>

            <button onclick="clearAllFilters()"><i class="bi bi-arrow-clockwise"></i> Reset</button>
        </div>

        <div class="task-grid" id="taskList"></div>
    </div>

    <!-- NEW: WATCHLIST SECTION -->
    <div id="watchlistSection" class="hidden">
        <div class="stats-bar">
            <div class="stat-box"><i class="bi bi-camera-reels"></i> Total: <span id="watchTotalCount">0</span></div>
            <div class="stat-box"><i class="bi bi-play-circle"></i> Watching: <span id="watchWatchingCount">0</span></div>
            <div class="stat-box"><i class="bi bi-check-circle"></i> Watched: <span id="watchWatchedCount">0</span></div>
            <div class="stat-box"><i class="bi bi-bookmark"></i> Plan to Watch: <span id="watchPlanCount">0</span></div>
            <div class="stat-box"><i class="bi bi-star-fill"></i> Favorites: <span id="watchFavCount">0</span></div>
        </div>

        <div class="top-controls">
            <input type="text" id="watchSearchInput" onkeyup="loadWatchlist()" placeholder="üîç Search watchlist...">
            
            <select id="watchTypeFilter" onchange="loadWatchlist()">
                <option value="all">All Types</option>
                <option value="Movie">Movies</option>
                <option value="Series">Series</option>
                <option value="Anime">Anime</option>
                <option value="Documentary">Documentary</option>
                <option value="Other">Other</option>
            </select>

            <select id="watchStatusFilter" onchange="loadWatchlist()">
                <option value="all">All Status</option>
                <option value="Watching">Watching</option>
                <option value="Watched">Watched</option>
                <option value="Plan to Watch">Plan to Watch</option>
                <option value="On Hold">On Hold</option>
                <option value="Dropped">Dropped</option>
            </select>

            <select id="watchPlatformFilter" onchange="loadWatchlist()">
                <option value="all">All Platforms</option>
                <option value="Netflix">Netflix</option>
                <option value="Amazon Prime">Amazon Prime</option>
                <option value="Disney+">Disney+</option>
                <option value="HBO Max">HBO Max</option>
                <option value="Hulu">Hulu</option>
                <option value="YouTube">YouTube</option>
                <option value="Apple TV+">Apple TV+</option>
                <option value="Other">Other</option>
            </select>

            <select id="watchSortBy" onchange="loadWatchlist()">
                <option value="date-desc">Latest First</option>
                <option value="date-asc">Oldest First</option>
                <option value="title-asc">Title A-Z</option>
                <option value="title-desc">Title Z-A</option>
                <option value="rating-desc">Highest Rated</option>
                <option value="rating-asc">Lowest Rated</option>
            </select>

            <button onclick="clearWatchFilters()"><i class="bi bi-arrow-clockwise"></i> Reset</button>
        </div>

        <div class="task-grid" id="watchList"></div>
    </div>
</div>

<button class="add-btn" onclick="openAddModal()" title="Add New Item">+</button>

<!-- NEW: Random Pick Button (Only visible in Watchlist mode) -->
<button class="random-pick-btn hidden" id="randomPickBtn" onclick="showRandomPick()" title="Random Pick">
    <i class="bi bi-shuffle"></i>
</button>

<button class="secondary-btn" id="archiveBtn" onclick="openArchiveModal()" title="View Archive"><i class="bi bi-archive"></i></button>
<button class="secondary-btn" id="exportBtn" onclick="openExportModal()" title="Export/Import"><i class="bi bi-download"></i></button>

<!-- TASK MODAL -->
<div id="taskModal" class="modal">
    <div class="modal-content">
        <h3 id="modalTitle">Add New Task</h3>
        <input type="text" id="taskTitle" placeholder="Task Title">
        <textarea id="taskDesc" placeholder="Description"></textarea>
        
        <input type="text" id="taskTags" placeholder="Tags (comma separated)">
        
        <select id="taskCategory">
            <option value="">Select Category</option>
            <option value="Work">Work</option>
            <option value="Personal">Personal</option>
            <option value="Study">Study</option>
            <option value="Health">Health</option>
            <option value="Other">Other</option>
        </select>
        
        <input type="date" id="taskDeadline" placeholder="Deadline">
        
        <input type="time" id="taskTime" placeholder="Time (optional)">
        
        <select id="taskPriority">
            <option value="Low">Low Priority</option>
            <option value="Medium">Medium Priority</option>
            <option value="High">High Priority</option>
        </select>
        
        <label style="display:block;margin:10px 0;">
            <input type="checkbox" id="taskReminder"> Set Reminder
        </label>
        
        <button onclick="saveTask()"><i class="bi bi-save"></i> Save</button>
        <button onclick="closeModal()"><i class="bi bi-x-circle"></i> Cancel</button>
    </div>
</div>

<!-- NEW: WATCHLIST MODAL -->
<div id="watchModal" class="modal">
    <div class="modal-content">
        <h3 id="watchModalTitle">Add to Watchlist</h3>
        
        <input type="text" id="watchTitle" placeholder="Title (Movie/Series Name)">
        
        <select id="watchType">
            <option value="Movie">Movie</option>
            <option value="Series">Series</option>
            <option value="Anime">Anime</option>
            <option value="Documentary">Documentary</option>
            <option value="Other">Other</option>
        </select>
        
        <textarea id="watchDesc" placeholder="Description / Notes"></textarea>
        
        <select id="watchStatus">
            <option value="Plan to Watch">Plan to Watch</option>
            <option value="Watching">Currently Watching</option>
            <option value="Watched">Completed</option>
            <option value="On Hold">On Hold</option>
            <option value="Dropped">Dropped</option>
        </select>
        
        <input type="text" id="watchPlatform" placeholder="Platform (Netflix, Prime, etc.)">
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
            <input type="number" id="watchSeasons" placeholder="Seasons" min="0">
            <input type="number" id="watchEpisodes" placeholder="Episodes" min="0">
        </div>
        
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;">
            <input type="number" id="watchCurrentSeason" placeholder="Current Season" min="0">
            <input type="number" id="watchCurrentEpisode" placeholder="Current Episode" min="0">
        </div>
        
        <label style="display:block;margin:10px 0;font-weight:600;">Rating (1-10):</label>
        <input type="range" id="watchRating" min="0" max="10" value="0" step="0.5" 
               oninput="document.getElementById('ratingValue').innerText=this.value" 
               style="width:100%;">
        <div style="text-align:center;font-size:20px;font-weight:700;color:var(--primary-orange);" id="ratingValue">0</div>
        
        <input type="text" id="watchGenre" placeholder="Genre (Action, Drama, etc.)">
        
        <input type="number" id="watchYear" placeholder="Release Year" min="1900" max="2100">
        
        <input type="text" id="watchDirector" placeholder="Director/Creator">
        
        <input type="text" id="watchCast" placeholder="Main Cast (comma separated)">
        
        <label style="display:block;margin:10px 0;">
            <input type="checkbox" id="watchFavorite"> Mark as Favorite
        </label>
        
        <button onclick="saveWatch()"><i class="bi bi-save"></i> Save</button>
        <button onclick="closeWatchModal()"><i class="bi bi-x-circle"></i> Cancel</button>
    </div>
</div>

<!-- NEW: VIEW WATCHLIST ITEM MODAL -->
<div id="viewWatchModal" class="modal">
    <div class="modal-content">
        <h3 id="viewWatchTitle"></h3>
        <div id="viewWatchContent" style="background:#fff;padding:15px;border-radius:8px;margin:10px 0;min-height:100px;"></div>
        <div style="margin-top:15px;">
            <button onclick="closeViewWatchModal()">Close</button>
        </div>
    </div>
</div>

<!-- VIEW TASK MODAL -->
<div id="viewTaskModal" class="modal">
    <div class="modal-content">
        <h3 id="viewTaskTitle"></h3>
        <div id="viewTaskStatus"></div>
        <div id="viewTaskContent" style="background:#fff;padding:15px;border-radius:8px;margin:10px 0;min-height:100px;"></div>
        <div style="margin-top:15px;">
            <button onclick="closeViewModal()">Close</button>
        </div>
    </div>
</div>

<!-- ARCHIVE MODAL -->
<div id="archiveModal" class="modal">
    <div class="modal-content">
        <h3><i class="bi bi-archive-fill"></i> Archived Tasks</h3>
        <div id="archiveList" style="max-height:400px;overflow-y:auto;"></div>
        <div style="margin-top:15px;">
            <button onclick="closeArchiveModal()">Close</button>
        </div>
    </div>
</div>

<!-- EXPORT MODAL -->
<div id="exportModal" class="modal">
    <div class="modal-content">
        <h3>Export / Import Data</h3>
        
        <div id="exportTasksSection">
            <h4>Export Tasks</h4>
            <button onclick="exportTasks()"><i class="bi bi-download"></i> Export as JSON</button>
            <button onclick="exportTasksText()"><i class="bi bi-file-text"></i> Export as Text</button>
            <button onclick="exportTasksCSV()"><i class="bi bi-file-earmark-spreadsheet"></i> Export as CSV</button>
            
            <h4 style="margin-top:20px;">Import Tasks</h4>
            <input type="file" id="importFile" accept=".json" style="margin-bottom:10px;">
            <button onclick="importTasks()"><i class="bi bi-upload"></i> Import from JSON</button>
        </div>

        <div id="exportWatchSection" style="margin-top:20px;">
            <h4>Export Watchlist</h4>
            <button onclick="exportWatchlist()"><i class="bi bi-download"></i> Export as JSON</button>
            <button onclick="exportWatchlistText()"><i class="bi bi-file-text"></i> Export as Text</button>
            <button onclick="exportWatchlistCSV()"><i class="bi bi-file-earmark-spreadsheet"></i> Export as CSV</button>
            
            <h4 style="margin-top:20px;">Import Watchlist</h4>
            <input type="file" id="importWatchFile" accept=".json" style="margin-bottom:10px;">
            <button onclick="importWatchlist()"><i class="bi bi-upload"></i> Import from JSON</button>
        </div>
        
        <h4 style="margin-top:20px;">Preview</h4>
        <div class="import-export-area" id="exportPreview">Export data will appear here...</div>
        
        <div style="margin-top:15px;">
            <button onclick="closeExportModal()">Close</button>
        </div>
    </div>
</div>

<!-- NEW: RANDOM PICK MODAL -->
<div id="randomModal" class="modal random-modal">
    <div class="modal-content">
        <h2>üé¨ What Should You Watch?</h2>
        <div id="randomContent"></div>
        <div style="margin-top:25px;">
            <button onclick="showRandomPick()" style="margin-right:10px;">
                <i class="bi bi-shuffle"></i> Pick Again
            </button>
            <button onclick="closeRandomModal()" style="background:#e74c3c;color:white;">
                Close
            </button>
        </div>
    </div>
</div>

<!-- TOAST NOTIFICATION -->
<div id="toast" class="toast"></div>

<script src="../script/planner.js"></script>
</body>
</html>